<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>David Unterberger</title>

<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@300;400;600;800&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

<style>
html, body, #root {
  margin: 0;
  padding: 0;
  background: #0f1214;
  color: #e8eef1;
  font-family: "Source Code Pro", monospace;
}

#root {
  position: relative;
  min-height: 100vh;
}

.hero-bg {
  background-image:
    linear-gradient(to bottom, rgba(15, 18, 20, 0.7), rgba(15, 18, 20, 0.9)),
    url("titel_background.png");
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

.glass {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 255, 255, 0.06);
  backdrop-filter: blur(10px);
}

.status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; }
.online { background: #23a55a; box-shadow: 0 0 10px #23a55a; }
.idle { background: #f0b232; }
.dnd { background: #f23f43; }
.offline { background: #80848e; }

/* The background canvas container */
.canvas-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1; /* Strictly behind everything */
  pointer-events: none;
}
</style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

const DISCORD_ID = "780384263987920937";
const STEAM_ID = "76561199474685726";
const GITHUB_USER = "David-Unterberger";

/* --- Animated Background Component --- */
function Background() {
  const mountRef = useRef(null);

  useEffect(() => {
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
    
    renderer.setSize(window.innerWidth, window.innerHeight);
    mountRef.current.appendChild(renderer.domElement);
    camera.position.z = 40;

    const geometry = new THREE.PlaneGeometry(150, 150, 80, 80);
    const material = new THREE.MeshBasicMaterial({
      color: 0x4c1d95,
      wireframe: true,
      transparent: true,
      opacity: 0.12
    });

    const plane = new THREE.Mesh(geometry, material);
    plane.rotation.x = -Math.PI / 2.5;
    scene.add(plane);

    let frameId;
    const animate = () => {
      frameId = requestAnimationFrame(animate);
      const t = Date.now() * 0.0004;
      const pos = plane.geometry.attributes.position;
      for (let i = 0; i < pos.count; i++) {
        const x = pos.getX(i);
        const y = pos.getY(i);
        const z = Math.sin(x * 0.15 + t) * 1.2 + Math.cos(y * 0.15 + t) * 1.2;
        pos.setZ(i, z);
      }
      pos.needsUpdate = true;
      renderer.render(scene, camera);
    };
    animate();

    const handleResize = () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    };
    window.addEventListener("resize", handleResize);

    return () => {
      cancelAnimationFrame(frameId);
      window.removeEventListener("resize", handleResize);
      if (mountRef.current) mountRef.current.removeChild(renderer.domElement);
    };
  }, []);

  return <div className="canvas-container" ref={mountRef} />;
}

/* --- Hero --- */
function Hero() {
  const roles = ["Game Developer", "Systems Programmer", "Procedural Enthusiast"];
  const [i, setI] = useState(0);

  useEffect(() => {
    const t = setInterval(() => setI(x => (x + 1) % roles.length), 3000);
    return () => clearInterval(t);
  }, []);

  return (
    <section className="hero-bg min-h-screen flex flex-col justify-center items-center text-center px-6">
      <h1 className="text-5xl md:text-6xl font-bold mb-6">David Unterberger</h1>
      <p className="text-lg text-zinc-300 max-w-2xl mb-6">
        Hobby game developer since 2020. Focused on procedural terrain, simulation systems and shader experimentation.
      </p>
      <div className="text-xl text-violet-400 font-semibold h-8">{roles[i]}</div>
    </section>
  );
}

/* --- Current Project --- */
function CurrentProject() {
  return (
    <section className="max-w-5xl mx-auto px-6 py-20 relative z-10">
      <h2 className="text-2xl font-bold mb-8">Current Project</h2>
      <div className="glass p-8 rounded-xl">
        <h3 className="text-xl font-semibold mb-4">Procedural Terrain & Shader Engine Experiments</h3>
        <p className="text-zinc-300 mb-6">Building modular terrain systems using layered noise stacks and custom shader pipelines.</p>
        <div className="flex gap-3 flex-wrap mb-6">
          {["C#", "Shaders", "Procedural Gen", "Simulation"].map(tag => (
            <span key={tag} className="px-3 py-1 bg-violet-600/20 rounded text-sm">{tag}</span>
          ))}
        </div>
        <div className="flex gap-4">
          <a href="https://github.com/David-Unterberger" target="_blank" className="px-4 py-2 rounded glass hover:scale-105 transition">GitHub</a>
          <a href="https://davebbx.itch.io" target="_blank" className="px-4 py-2 rounded glass hover:scale-105 transition">itch.io</a>
        </div>
      </div>
    </section>
  );
}

/* --- Discord --- */
function Discord() {
  const [data, setData] = useState(null);
  useEffect(() => {
    const ws = new WebSocket("wss://api.lanyard.rest/socket");
    ws.onopen = () => ws.send(JSON.stringify({ op: 2, d: { subscribe_to_id: DISCORD_ID } }));
    ws.onmessage = (e) => {
      const p = JSON.parse(e.data);
      if (p.t === "INIT_STATE" || p.t === "PRESENCE_UPDATE") setData(p.d);
    };
    return () => ws.close();
  }, []);

  if (!data) return null;
  const { discord_user: user, discord_status: status, activities } = data;
  const avatarURL = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`;

  return (
    <section className="max-w-5xl mx-auto px-6 py-20 relative z-10">
      <h2 className="text-2xl font-bold mb-8">Discord Status</h2>
      <div className="glass p-8 rounded-xl flex items-center gap-6">
        <img src={avatarURL} className="w-16 h-16 rounded-full border-2 border-zinc-700" alt="avatar"/>
        <div>
          <div className="text-lg font-semibold">{user.username}</div>
          <div className="flex items-center text-sm">
            <span className={`status-dot ${status}`}></span>
            <span className="capitalize">{status}</span>
          </div>
        </div>
      </div>
    </section>
  );
}

/* --- App Root --- */
function App() {
  return (
    <>
      <Background />
      <Hero />
      <CurrentProject />
      <Discord />
      <footer className="text-center py-16 text-zinc-600 text-sm relative z-10">
        &copy; {new Date().getFullYear()} David Unterberger
      </footer>
    </>
  );
}

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(<App />);
</script>

</body>
</html>
